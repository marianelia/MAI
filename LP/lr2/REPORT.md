# № Отчет по лабораторной работе №2
## по курсу "Логическое программирование"

## Решение логических задач

## Введение

Существует два основный метода решения логических задач: метод порождения и проверок и метод ветвей и границ. Метод порождения и проверок заключается в том, что сначала генерируется множество данных, затем проиходит проверка предикатами на соответствие условию задачи, в случае неуспеха, происходит возврат и рассмотрение следующего решения, в случае успеха, решение используется дальше или возвращается пользователю. Во втором методе части возможных решений отсекаются на раннем этапе работы программы или не генерируются вообще.
Для решения логических задач Пролог удобен тем, что дает возможность рассмотрения большого количества вариантов решения задачи и выбора из них подходящих. Также наличие бэктрэкинг позволяет при каждом неуспехе возвращатся на шаг назад, и продолжать поиск в дереве вариантов используя другие значения переменых. 

## Задание

14. В педагогическом институте Аркадьева, Бабанова, Корсакова, Дашков, Ильин и Флеров преподают географию, английский язык, французский язык, немецкий язык, историю и математику. Преподаватель немецкого языка и преподаватель математики в студенческие годы занимались художественной гимнастикой. Ильин старше Флерова, но стаж работы у него меньше, чем у преподавателя географии. Будучи студентками, Аркадьева и Бабанова учились вместе в одном университете. Все остальные окончили педагогический институт. Флеров отец преподавателя французского языка. Преподаватель английского языка самый старший из всех и по возрасту и по стажу. Он работает в этом институте с тех пор, как окончил его. Преподаватели математики и истории его бывшие студенты. Аркадьева старше преподавателя немецкого языка. Кто какой предмет преподает?

## Принцип решения

Реализован главный предикат `solve(List)`, позволяющий получить решение поставленной задачи, а также предикат `res_solve(List)`, позволяющий вывести решение задачи в более красивом виде, а именно без повторений.
Стоит заметить, что решение у данной задачи может быть не одно, так как из фразы "Преподаватель немецкого языка и преподаватель математики в студенческие годы занимались художественной гимнастикой." можно сделать вывод о том, что преподаватель немецкого и преподаватель математики - женщины, а можно этот вывод не делать, и тогда решение задачи может быть иным. В этой программе рассматривается первый случай, а значит при описании предикатов, важно знать пол человека. Также для простоты описания в будущем написан предикат `human(X)`. И запишем факты об учебе в институте.

```Prolog
female(arkadeva). 
female(babanova).
female(karsakova).
male(dashkov).
male(ilin).
male(flerov).

human(X) :- male(X).
human(X) :- female(X).

inst(karsakova).    % Все, кроме Аркадьева и Бабанова окончили педагогический институт
inst(dashkov). 
inst(ilin).
inst(flerov). 
```
В самом предикате `solve(List)` создадим список с фиксированными профессиями, для того, чтобы уменьшить варианты перебора. Предикат `unique_el(X)` проверяет на уникальность имен, сопоставляемых с профессиями. Далее после необходимых проверок на соответствие условию, создается список, для выполнения условия соответствия возрастов (1 - самый младший, 6 - самый старший) и описывается условия задачи, связанный с возрастом. После этого создается еще один список для учета соответствия стажа работы (1 - самый маленький, 6 - самый большой). Далее решение в виде списка переписывается в более читаемый вид.

```Prolog
solve(Ans) :-    
    L = [person(G, geography, Age_g, Experience_g), person(E, english, Age_e, Experience_e), 
            person(F, french, Age_f, Experience_f), person(D, german, Age_d, Experience_d), 
            person(H, history, Age_h, Experience_h), person(M, math, Age_m, Experience_m)],          
    human(G), human(E), human(F), human(D), human(H), human(M), unique_el([G,E,F,D,H,M]),
    female(D), female(M),         %Преподаватель немецкого языка и преподаватель математики в студенческие годы занимались художественной гимнастикой
    inst(E), inst(M), inst(H),    %преп. английского работает в этом институте с тех пор, как окончил его. Преподаватели математики и истории его бывшие студенты
    permute1([Age_g,Age_e,Age_f,Age_d,Age_h,Age_m], [1,2,3,4,5,6]),
    Age_e =:= 6,                  %Преподаватель английского языка самый старший из всех по возрасту
    member(person(ilin,_,Age_ilin,_),L), member(person(flerov,_,Age_flerov,_),L),
    not(member(person(arkadeva,german,_,_),L)),
    Age_ilin > Age_flerov,        %Ильин старше Флерова
    Age_flerov > Age_f,           % Флеров отец преподавателя французского языка
    permute1([Experience_g,Experience_e,Experience_f,Experience_d,Experience_h,Experience_m],[1,2,3,4,5,6]),
    member(person(ilin,_,_,Experience_i),L),
    Experience_e =:= 6,           % Преподаватель английского языка самый старший из всех по стажу
    Experience_i < Experience_g,  % стаж работы Ильина меньше, чем у преподавателя географии

Ans = [ans_person(G, geography),ans_person(E, english),ans_person(F, french),ans_person(D, german),ans_person(H, history),ans_person(M, math)].
```
Итоговый ответ выводится с помощью предиката `res_solve(List)`, который работает через setof, тем самым отсекая лишние повторяющиеся решения.

```Prolog
res_solve(List):- setof(X, solve(X), List).
```
Результат работы:

```
?- res_solve(L).
L = [[ans_person(flerov, geography), ans_person(dashkov, english), ans_person(arkadeva, french), ans_person(babanova, german), ans_person(ilin, history), ans_person(karsakova, math)]].
```
То есть ответ: 
Флеров - пр. географии
Дашков - пр. английского языка
Аркадьева - пр. французского языка
Баранова - пр. немецкого языка
Ильин - пр. истории
Карсакова - пр. математики

Сложность решения задачи является степенной, так как в реализации присутствует рекурсия.

## Выводы
Результатом работы программы является единственно верное непротиворечивое решение. Все условия задачи соблюдены. Решение является эффективным, так как при сопоставлении возрастов и опыта с профессиями, сначала учитываются более жесткие условия, накладываемые на опыт и возраст, что позволяет сократить колчество вариантов перебора.

Пролог позволяет искать решения логических задач. Описав ряд условий, отсекаеются неподходящие варианты и находится нужное решение. Это проще, чем решать задачу вручную, проверяя все соотношения. Однако нужно правильно описывать условия и предикаты, чтобы в конце получить непротиворечивое решение.
И все же, если нужно решить одну небольшую задачу, то проще и быстрее будет слделать ее на листе, ручным способом.
Но если нужно решить много подобных задач, так как в Прологе они будут решаться мехаически, изменяются только предикаты с условиями, то, возможно, можно описать все возможные проверки из условий и таким образом решать целые типы задач.  




